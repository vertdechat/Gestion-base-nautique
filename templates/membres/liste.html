{% extends 'layout.html' %}
{% block title %}Liste des membres{% endblock %}

{% block content %}
<h2 class="mb-4">
  <span class="emoji-pill heading-emoji">ğŸ‘¤</span> Liste des membres
</h2>

<!-- Premier formulaire : recherche & filtre en GET -->
<form method="get" class="row g-3 mb-3">

    <div class="col-md-3">
      <input type="text" name="recherche" value="{{ recherche }}" placeholder="Recherche nom/prenom" class="form-control">
    </div>
  
    <div class="col-md-2">
      <select name="statut" class="form-select">
        <option value="tous" {% if statut == 'tous' %}selected{% endif %}>Tous</option>
        <option value="ajour" {% if statut == 'ajour' %}selected{% endif %}>Ã€ jour</option>
        <option value="pasajour" {% if statut == 'pasajour' %}selected{% endif %}>Pas Ã  jour</option>
      </select>
    </div>
  
    <div class="col-md-2 d-flex align-items-end">
      <button type="submit" class="btn btn-primary w-100">Filtrer</button>
    </div>
  
    <div class="col-md-2 offset-md-5 text-end">
      <a href="/membres/ajouter" class="btn btn-success">â• Nouveau membre</a>
    </div>
  
      <!-- DeuxiÃ¨me formulaire : bouton POST pour rÃ©initialiser les cotisations -->


  </form>
  
  <div class="text-end mb-3">
    <a href="/membres/reinitialiser_cotisations" 
       class="btn btn-outline-danger" 
       style="opacity:0.8;" 
       onclick="return confirm('Confirmer ?')">
      RÃ©initialiser cotisations
    </a>
  </div>
  
  
  <!-- Tableau des membres ici... -->
  

<table class="table table-bordered table-striped">
  <thead>
    <tr>
      <th>Nom</th>
      <th>PrÃ©nom</th>
      <th>Tel1</th>
      <th>Cotisation</th>
      <th>Mode paiement</th>
      <th>Date inscription</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    {% for m in membres %}
    <tr>
      <td>{{ m.nom }}</td>
      <td>{{ m.prenom }}</td>
      <td>{{ m.tel1 or 'â€”' }}</td>
      <td>{% if m.cotisation_a_jour %}âœ… Ã€ jour{% else %}âŒ Pas Ã  jour{% endif %}</td>
      <td>{{ m.mode_paiement or 'â€”' }}</td>
      <td>{{ m.date_inscription or 'â€”' }}</td>
      <td>
        <a href="/membres/modifier/{{ m.id }}" class="btn btn-sm btn-outline-secondary">âœï¸</a>
        <a href="/membres/supprimer/{{ m.id }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Supprimer ce membre ?')">ğŸ—‘ï¸</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% if membres|length == 0 %}
<div class="alert alert-info">Aucun membre trouvÃ©.</div>
{% endif %}
{% endblock %}
